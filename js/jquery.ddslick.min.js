(function(e){function o(e,t){var n=e.data("ddslick"),r=e.find(".dd-selected"),i=r.siblings(".dd-selected-value"),s=e.find(".dd-options"),o=r.siblings(".dd-pointer"),u=e.find(".dd-option").eq(t),l=u.closest("li"),c=n.settings,h=n.settings.data[t];e.find(".dd-option").removeClass("dd-option-selected"),u.addClass("dd-option-selected"),n.selectedIndex=t,n.selectedItem=l,n.selectedData=h,c.showSelectedHTML?r.html((h.imageSrc?'<img class="dd-selected-image'+(c.imagePosition=="right"?" dd-image-right":"")+'" src="'+h.imageSrc+'" />':"")+(h.text?'<label class="dd-selected-text">'+h.text+"</label>":"")+(h.description?'<small class="dd-selected-description dd-desc'+(c.truncateDescription?" dd-selected-description-truncated":"")+'" >'+h.description+"</small>":"")):r.html(h.text),i.val(h.value),n.original.val(h.value),e.data("ddslick",n),a(e),f(e),typeof c.onSelected=="function"&&c.onSelected.call(this,n)}function u(t){var n=t.find(".dd-select"),r=n.siblings(".dd-options"),i=n.find(".dd-pointer"),s=r.is(":visible");e(".dd-click-off-close").not(r).slideUp(50),e(".dd-pointer").removeClass("dd-pointer-up"),s?(r.slideUp("fast"),i.removeClass("dd-pointer-up")):(r.slideDown("fast"),i.addClass("dd-pointer-up")),l(t)}function a(e){e.find(".dd-options").slideUp(50),e.find(".dd-pointer").removeClass("dd-pointer-up").removeClass("dd-pointer-up")}function f(e){var t=e.find(".dd-select").css("height"),n=e.find(".dd-selected-description"),r=e.find(".dd-selected-image");n.length<=0&&r.length>0&&e.find(".dd-selected-text").css("lineHeight",t)}function l(t){t.find(".dd-option").each(function(){var n=e(this),r=n.css("height"),i=n.find(".dd-option-description"),s=t.find(".dd-option-image");i.length<=0&&s.length>0&&n.find(".dd-option-text").css("lineHeight",r)})}e.fn.ddslick=function(n){if(t[n])return t[n].apply(this,Array.prototype.slice.call(arguments,1));if(typeof n=="object"||!n)return t.init.apply(this,arguments);e.error("Method "+n+" does not exists.")};var t={},n={data:[],keepJSONItemsOnTop:!1,width:260,height:null,background:"#eee",selectText:"",defaultSelectedIndex:null,truncateDescription:!0,imagePosition:"left",showSelectedHTML:!0,clickOffToClose:!0,onSelected:function(){},onChanged:function(){}},r='<div class="dd-select"><input class="dd-selected-value" type="hidden" /><a class="dd-selected"></a><span class="dd-pointer dd-pointer-down"></span></div>',i='<ul class="dd-options"></ul>',s='<style id="css-ddslick" type="text/css">.dd-select{ border-radius:2px; border:solid 1px #ccc; position:relative; cursor:pointer;}.dd-desc { color:#aaa; display:block; overflow: hidden; font-weight:normal; line-height: 1.4em; }.dd-selected{ overflow:hidden; display:block; padding:10px; font-weight:bold;}.dd-pointer{ width:0; height:0; position:absolute; right:10px; top:50%; margin-top:-3px;}.dd-pointer-down{ border:solid 5px transparent; border-top:solid 5px #000; }.dd-pointer-up{border:solid 5px transparent !important; border-bottom:solid 5px #000 !important; margin-top:-8px;}.dd-options{ border:solid 1px #ccc; border-top:none; list-style:none; box-shadow:0px 1px 5px #ddd; display:none; position:absolute; z-index:2000; margin:0; padding:0;background:#fff; overflow:auto;}.dd-option{ padding:10px; display:block; border-bottom:solid 1px #ddd; overflow:hidden; text-decoration:none; color:#333; cursor:pointer;-webkit-transition: all 0.25s ease-in-out; -moz-transition: all 0.25s ease-in-out;-o-transition: all 0.25s ease-in-out;-ms-transition: all 0.25s ease-in-out; }.dd-options > li:last-child > .dd-option{ border-bottom:none;}.dd-option:hover{ background:#f3f3f3; color:#000;}.dd-selected-description-truncated { text-overflow: ellipsis; white-space:nowrap; }.dd-option-selected { background:#f6f6f6; }.dd-option-image, .dd-selected-image { vertical-align:middle; float:left; margin-right:5px; max-width:14px;}.dd-image-right { float:right; margin-right:15px; margin-left:5px;}.dd-container{ position:relative;}? .dd-selected-text { font-weight:bold}?</style>';e("#css-ddslick").length<=0&&e(s).appendTo("head"),t.init=function(t){var t=e.extend({},n,t);return this.each(function(){var n=e(this),s=n.data("ddslick"),a=n.attr("name");if(!s){var f=[],l=t.data;n.find("option").each(function(){var t=e(this),n=t.data();f.push({text:e.trim(t.text()),value:t.val(),selected:t.is(":selected"),description:n.description,imageSrc:n.imagesrc})}),t.keepJSONItemsOnTop?e.merge(t.data,f):t.data=e.merge(f,t.data);var c=n,h=e('<div id="'+n.attr("id")+'"></div>');n.replaceWith(h),n=h,n.addClass("dd-container").append(r).append(i),e("input",n).attr("name",a);var f=n.find(".dd-select"),p=n.find(".dd-options");p.css({width:t.width}),f.css({width:t.width,background:t.background}),n.css({width:t.width}),t.height!=null&&p.css({height:t.height,overflow:"auto"}),e.each(t.data,function(e,n){n.selected&&(t.defaultSelectedIndex=e),p.append('<li><a class="dd-option">'+(n.value?' <input class="dd-option-value" type="hidden" value="'+n.value+'" />':"")+(n.imageSrc?' <img class="dd-option-image'+(t.imagePosition=="right"?" dd-image-right":"")+'" src="'+n.imageSrc+'" />':"")+(n.text?' <label class="dd-option-text">'+n.text+"</label>":"")+(n.description?' <small class="dd-option-description dd-desc">'+n.description+"</small>":"")+"</a>"+"</li>")});var d={settings:t,original:c,selectedIndex:-1,selectedItem:null,selectedData:null};n.data("ddslick",d);if(t.selectText.length>0&&t.defaultSelectedIndex==null)n.find(".dd-selected").html(t.selectText);else{var v=t.defaultSelectedIndex!=null&&t.defaultSelectedIndex>=0&&t.defaultSelectedIndex<t.data.length?t.defaultSelectedIndex:0;o(n,v)}n.find(".dd-select").on("click.ddslick",function(){u(n)}),n.find(".dd-option").on("click.ddslick",function(){o(n,e(this).closest("li").index()),typeof t.onChanged=="function"&&t.onChanged.call(this,d)}),t.clickOffToClose&&(p.addClass("dd-click-off-close"),n.on("click.ddslick",function(e){e.stopPropagation()}),e("body").on("click",function(){e(".dd-click-off-close").slideUp(50).siblings(".dd-select").find(".dd-pointer").removeClass("dd-pointer-up")}))}})},t.select=function(t){return this.each(function(){t.index&&o(e(this),t.index)})},t.open=function(){return this.each(function(){var t=e(this),n=t.data("ddslick");n&&u(t)})},t.close=function(){return this.each(function(){var t=e(this),n=t.data("ddslick");n&&a(t)})},t.destroy=function(){return this.each(function(){var t=e(this),n=t.data("ddslick");if(n){var r=n.original;t.removeData("ddslick").unbind(".ddslick").replaceWith(r)}})}})(jQuery)